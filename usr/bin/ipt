
#!/bin/bash

usage() {
  echo "Usage: ipt <options> [rulename]

  -e     enable rule
  -d     disable rule
  -dd    default drop
  -da    default accept
  -l     list enabled rules
  -la    list available rules
  -c     list enabled config
  -g     generate rules file
  -i     install rules into iptables
  -f     disable all rules
";
}

enable_rules() {
  for RULE in $*; do
    [ "$RULE" = "-e" ] && continue;
    iptenrule $RULE;
  done;

  echo "Don't forget to run 'ipt -i' to install the rules";
}

case "$1" in
  "-e")   enable_rules $* ;;
  "-dd")  iptpolicy -d ;;
  "-da")  iptpolicy -a ;;
  "-d")   iptdisrule $2 ;;
  "-l")   iptlist ;;
  "-la")  iptlist -a ;;
  "-c")   iptconf ;;
  "-g")   iptgen ;;
  "-i")   iptinstall ;;
  "-f")   iptflush ;;
  *) usage ;;
esac;
